<launch>
	<include file="$(find turtlebot_bringup)/launch/minimal.launch"/>
	<include file="$(find turtlebot_bringup)/launch/3dsensor.launch">
          <arg name="use_openni_launch" value="true" />
        </include>
        <node pkg="topic_tools" type="throttle" name="iap_cloud_throttle"
              args="messages /camera/depth/points 1.0 /camera/depth/points_throttled" lazy="true" />


	<node pkg="nodelet" type="nodelet" name="nodelet_manager" args="manager"/>
	<node pkg="nodelet" type="nodelet" name="cmd_vel_mux" args="load cmd_vel_mux/CmdVelMuxNodelet nodelet_manager">
		<param name="subscribers_cfg_file" value="$(find iap_bringup)/param/cmd_vel_mux.yaml" />
		<remap from="cmd_vel_mux/cmd_vel" to="/cmd_vel"/>
		<remap from="cmd_vel_mux/mux_cmd_vel" to="mobile_base/commands/velocity"/>
	</node>
	<node pkg="nodelet" type="nodelet" name="kobuki_safety_controller" args="load kobuki_safety_controller/SafetyControllerNodelet kobuki">
	    <remap from="kobuki_safety_controller/cmd_vel" to="cmd_vel_mux/input/safety"/>
	    <remap from="kobuki_safety_controller/events/bumper" to="mobile_base/events/bumper"/>
	    <remap from="kobuki_safety_controller/events/cliff" to="mobile_base/events/cliff"/>
	    <remap from="kobuki_safety_controller/events/wheel_drop" to="mobile_base/events/wheel_drop"/>
	</node>

</launch>

